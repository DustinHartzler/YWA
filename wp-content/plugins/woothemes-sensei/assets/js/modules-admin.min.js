function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)"),r=a.exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}jQuery(document).ready(function(){jQuery(".sortable-module-list").sortable(),jQuery(".sortable-tab-list").disableSelection(),jQuery(".sortable-module-list").bind("sortstop",function(){var e="";jQuery(this).find(".module").each(function(a){if(a>0&&(e+=","),e+=jQuery(this).find("span").attr("rel"),jQuery(this).removeClass("alternate"),jQuery(this).removeClass("first"),jQuery(this).removeClass("last"),0==a)jQuery(this).addClass("first alternate");else{var r=a%2;0==r&&jQuery(this).addClass("alternate")}}),jQuery('input[name="module-order"]').attr("value",e)}),jQuery("select.ajax_chosen_select_courses").ajaxChosen({method:"GET",url:ajaxurl,dataType:"json",afterTypeDelay:100,minTermLength:1,data:{action:"sensei_json_search_courses",security:modulesAdmin.search_courses_nonce,"default":""}},function(e){var a={};return jQuery.each(e,function(e,r){a[e]=r}),a}),jQuery("#sensei-module-add-toggle").on("click",function(){var e="wp-hidden-child",a=jQuery(this).parent().next("p#sensei-module-add"),r=a.children("#newmodule");return a.hasClass(e)?(a.removeClass(e),r.val(""),void r.focus()):void a.addClass(e)}),jQuery("#sensei-module-add-submit").on("click",function(){var e=getParameterByName("post"),a=jQuery(this).parent().children("#newmodule"),r=jQuery(this).parent().children("#add_module_nonce"),t=jQuery("#module_course_mb #taxonomy-module #module-all ul#modulechecklist"),s=a.val(),o=r.val();if(_.isEmpty(s)||_.isEmpty(o))return void a.focus();var n={newTerm:s,security:o,action:"sensei_add_new_module_term",course_id:e};jQuery.post(ajaxurl,n,function(e){if(e.success){var r=e.data.termId,s=e.data.termName;if(!(parseInt(r)>0)||_.isEmpty(s))return void a.focus();var o='<li id="module-'+r+'">';return o+='<label class="selectit">',o+='<input value="'+r+'" type="checkbox" checked="checked" name="tax_input[module][]" id="in-module-'+r+'">',o+=s,o+="</label></li>",t.prepend(o),a.val(""),void a.focus()}if("undefined"!=typeof e.data.errors&&"undefined"!=typeof e.data.errors.term_exists){var r=e.data.term.id,n=t.find("#module-"+r+" input");n.prop("checked","checked"),n.focus(),a.val("")}else console.log(e)})})});